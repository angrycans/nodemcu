<html>

<head>
  <title>Track</title>
  <link Content-Type="text/css" href="/style.css" rel="stylesheet" />
</head>

<body>
  <h1>Track</h1>

  <div id="track">
    <label for="name">Track Name </label>
    <br />
    <input type="text" id="trackname" name="name" required minlength="4" maxlength="32" size="32">
    <br />
    lat<br /><input type="text" id="lat" readonly size="16">
    <br />
    lng<br /><input type="text" id="lng" readonly size="16">
    <br />
    <input type="button" value="refresh" onclick="refresh()"> <input type="button" value="submit"
      onclick="submittrack()">

  </div>


  <script>
    function refresh() {
      fetch('/getlocation')
        .then(function (result) { return result.text(); })
        .then(function (e) {
          console.log(e);

          ret = JSON.parse(e);

          console.log(ret)
          if (ret.e.code > 0) {
            document.getElementById("lat").value = ret.data.lat;
            document.getElementById("lng").value = ret.data.lng;

          } else {
            document.getElementById("lat").value = "NULL"
            document.getElementById("lng").value = "NULL"
          }

        });

    };

    function submittrack() {

      if (document.getElementById("trackname").value.length == 0) {
        alert("Please input track name");
        return;
      }
      if (document.getElementById("lat").value.length > 0 && document.getElementById("lng").value.length > 0) {
        fetch('/settrack')
          .then(function (result) { return result; })
          .then(function (e) {
            console.log("listsd", e)
          });

      } else {
        alert("Please refresh location lat,lng");
      }


    };

  </script>
</body>

</html>